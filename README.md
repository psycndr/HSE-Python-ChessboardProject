# HSE Chess Board with Looped Movement

### Учебное задание "Основы Python", 2 курс, Бизнес-Информатика, НИУ ВШЭ

## Описание проекта

Проект представляет собой учебное задание в рамках курса "Основы Python" второго курса направления "Бизнес-Информатика" НИУ ВШЭ. Основная цель задания — реализация шахматной доски с фигурами и правилами шахмат, включая дополнительные возможности.

Проект написан на Python и включает в себя базовые элементы игры в шахматы: доску, шахматные фигуры и механику их движения. 

## Техническое задание (ТЗ):

1. Реализовать стандартную шахматную доску 8x8.
2. Поддерживать движение всех шахматных фигур в соответствии с их правилами.
3. Добавить возможность зацикливания доски, при котором фигуры пересекают край и появляются на противоположной стороне.
4. Поддерживать команды управления:
   - Включение и отключение режима зацикливания.
   - Просмотр текущего состояния доски.
   - Просмотр баланса белых и чёрных фигур.
   - Сохранение состояния игры в формате JSON.
5. JSON-форматирование: Возможность сохранения состояния доски и его восстановления из JSON.
6. Проверка количества фигур: Определение количества черных и белых фигур на доске.
7. Подсчет баланса: Рассчитать разницу между количеством очков белых и черных фигур.

## Задачи

1. Создание класса Board для представления шахматной доски:
    - Инициализация доски с возможностью ее загрузки из JSON.
    - Визуализация доски в текстовом формате.
2. Создание базового класса Piece для всех фигур:
    - Каждая фигура имеет цвет, стоимость, текстовое название и уникальный метод can_move, проверяющий, может ли фигура переместиться на указанное место.
    - Поддержка всех стандартных шахматных фигур: пешка, ладья, конь, слон, ферзь и король.
3. Реализация зацикливания доски:
    - Возможность перевода доски в режим, где фигуры могут двигаться через края.

## Основные классы и методы:

- **Board** — основной класс, отвечающий за создание и управление шахматной доской. В нём реализованы методы для работы с режимом зацикливания, выполнения ходов, сохранения состояния в JSON и прочее.
  
- **Piece** — базовый класс для шахматных фигур. От него наследуются конкретные фигуры:
  - `King` (король)
  - `Queen` (ферзь)
  - `Rook` (ладья)
  - `Bishop` (слон)
  - `Knight` (конь)
  - `Pawn` (пешка)
  В каждом классе реализован метод `can_move`, который проверяет корректность хода фигуры в зависимости от её типа.

### Пример; Класс пешки:

```python
class Pawn(Piece):
    def __init__(self, is_white: bool):
        super().__init__(is_white, "p", 1)

    def can_move(self, board: 'Board', from_pos: List[int], to_pos: List[int]) -> bool:
        """ Проверка возможного хода пешки """
        direction = -1 if self.is_white else 1
        start_row = 6 if self.is_white else 1

        delta_col = to_pos[0] - from_pos[0]
        delta_row = to_pos[1] - from_pos[1]
        if delta_col == 0:  # Пешка движется вперед
            # Пешка двигается на одну клетку
            if delta_row == direction and board[to_pos] is None:
                return True
            # Пешка двигается на две клетки с начальной позиции
            if delta_row == 2 * direction and from_pos[1] == start_row and board[to_pos] is None:
                return True
            # Пешка двигается через край
            if from_pos[1] in (7, 0) and board.is_looped and board[to_pos] is None and abs(delta_row) == 7:
                return True
        elif (abs(delta_col) == 1 or abs(delta_col) == 7 and board.is_looped) and delta_row == direction:
            # Захват фигуры
            return isinstance(board[to_pos], Piece) and board[to_pos].is_white != self.is_white

        return False
```

## Пример использования:

Игрок может управлять доской с помощью команд, вводимых через консоль. Примеры команд:
- Ход фигуры: `e2-e4` (координаты хода в формате `xi-zj`)
- Включение режима зацикливания: `make_looped`
- Отключение режима зацикливания: `make_default`
- Показать баланс фигур белых: `balance white`
- Показать баланс фигур чёрных: `balance black`
- Сохранить текущее состояние игры: `dump`
- Показать текущее состояние доски: `draw`
- Закончить игру: `exit`

В случае ошибки в ответ на ввод пользователя выводится сообщение вида: `«Error. Type: ХХХ.»`.
- `Wrong input format.` – Для неправильного формата ввода хода.
- `The piece cannot make the specified move.` – Выбранная фигура не может сделать указанный ход, первая позиция в нотации не содержит фигуру, или содержит вражескую фигуру.

## Пример работы программы:

Вводимые команды пользователя начинаются со знака ">", который добавлен только для визуального отображения.
```
white 1:
> a2-a4
black 1:
> a7-a5
white 2:
> draw
   A B C D E F G H

8  r n b q k b n r  8
7  . p p p p p p p  7
6  . . . . . . . .  6
5  p . . . . . . .  5
4  P . . . . . . .  4
3  . . . . . . . .  3
2  . P P P P P P P  2
1  R N B Q K B N R  1

   A B C D E F G H
```

## Особенности отображения фигур:
Фигуры белого цвета обозначаются заглавными буквами (например, `P` для пешки, `R` для ладьи и т.д.).

Фигуры черного цвета пишутся строчными буквами (например, `p` для пешки, `r` для ладьи и т.д.).

## Установка и запуск
Склонируйте репозиторий:
```
git clone https://github.com/psycndr/HSE-Python-ChessboardProject
```
Перейдите в директорию проекта:
```
cd */HSE-Python-ChessboardProject
```
Запустите игру:
```
python main.py
```

## Задачи для будущего развития:

- Добавление механики "шах" и "мат".
- Добавление сложных правил ходов для пешек (взятие на проходе и превращение в фигуру)
- Визуализация шахматной доски через графический интерфейс.
